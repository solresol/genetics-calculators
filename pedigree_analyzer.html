<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genetic Pedigree Probability Analyzer</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="main-area">
            <h1>Genetic Pedigree Probability Analyzer</h1>
            <canvas id="pedigreeCanvas" width="800" height="600"></canvas>
            <div id="statusMessage" style="background: #e9ecef; padding: 10px; border-radius: 4px; margin-top: 10px; font-style: italic; min-height: 20px;">
                Select/Move mode: Click to select, drag to move, right-click to toggle affected status
            </div>
            <div class="controls">
                <div class="mode-buttons">
                    <button id="selectBtn" class="mode-btn active">Select/Move</button>
                    <button id="addMaleBtn" class="mode-btn">Add Male</button>
                    <button id="addFemaleBtn" class="mode-btn">Add Female</button>
                    <button id="addRelationBtn" class="mode-btn">Add Relation</button>
                    <button id="addChildBtn" class="mode-btn">Add Child</button>
                <button id="deleteBtn" class="mode-btn" style="background: #dc3545;">Delete</button>
                </div>
                <button id="clearBtn">Clear All</button>
                <input type="file" id="loadFileInput" accept=".json" style="display:none">
                <button id="loadFileBtn">Load File</button>
                <select id="scenarioSelect">
                    <option value="">Load Example...</option>
                </select>
                <button id="loadScenarioBtn">Load Example</button>
                <button id="saveFileBtn">Save File</button>
            </div>
        </div>
        
        <div class="control-panel">
            <div class="control-group">
                <label>Genetic Condition:</label>
                <select id="conditionSelect">
                    <option value="cf">Cystic Fibrosis</option>
                    <option value="sma">Spinal Muscular Atrophy</option>
                    <option value="tay">Tay Sachs Disease</option>
                    <option value="pku">Phenylketonuria</option>
                    <option value="hemo">Hemochromatosis</option>
                </select>
            </div>
            
            <div class="frequency-table">
                <h3>Population Carrier Frequencies</h3>
                <table id="frequencyTable">
                    <thead>
                        <tr>
                            <th>Population</th>
                            <th>Frequency</th>
                        </tr>
                    </thead>
                    <tbody id="frequencyTableBody">
                    </tbody>
                </table>
            </div>
            
            <div class="control-group">
                <label>Optimization:</label>
                <button id="startOptBtn">Start Optimization</button>
                <button id="stepOptBtn">Step Once</button>
                <button id="stepNodeBtn">Step Node</button>
                <button id="stopOptBtn" disabled>Stop</button>
                <button id="resetBtn">Reset Probabilities</button>
            </div>
            
            <div class="optimization-status" id="optimizationStatus">
                <div>Iterations: <span id="iterationCount">0</span></div>
                <div>Negative Log-Likelihood: <span id="likelihood">0.000</span></div>
                <div>Probability Delta: <span id="probDelta">0.000</span></div>
                <div>Status: <span id="optStatus">Ready</span></div>
            </div>
            <div id="dataErrors" style="color:#d00;margin-top:4px"></div>

            <div class="individual-info" id="individualInfo">
                Click on an individual to see details
            </div>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>